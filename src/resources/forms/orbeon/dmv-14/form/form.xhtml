<!--
  Copyright (C) 2010 Orbeon, Inc.

  This program is free software; you can redistribute it and/or modify it under the terms of the
  GNU Lesser General Public License as published by the Free Software Foundation; either version
  2.1 of the License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
  without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  See the GNU Lesser General Public License for more details.

  The full text of the license is available at http://www.gnu.org/copyleft/lesser.html
  -->
<xh:html xmlns:xh="http://www.w3.org/1999/xhtml"
            xmlns:xxi="http://orbeon.org/oxf/xml/xinclude"
            xmlns:ev="http://www.w3.org/2001/xml-events"
            xmlns:xi="http://www.w3.org/2001/XInclude"
            xmlns:xf="http://www.w3.org/2002/xforms"
            xmlns:saxon="http://saxon.sf.net/"
            xmlns:xs="http://www.w3.org/2001/XMLSchema"
            xmlns:fr="http://orbeon.org/oxf/xml/form-runner"
            xmlns:xxf="http://orbeon.org/oxf/xml/xforms"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xmlns:dmv="http://orbeon.org/oxf/examples/dmv">
    <xh:head>
        <xh:style type="text/css">
            .yui-skin-sam .yui-dt .xbl-fr-california-plate .fr-plate-table { margin: auto; border: none }
            .yui-skin-sam .yui-dt .xbl-fr-california-plate .fr-plate-table td { text-align: center; border: none }
            .fr-grid .xforms-mediatype-image img { margin: auto }

            .fr-grid-content .xforms-control, .fr-grid-content .fr-component-group, .fr-grid-content span.xbl-fr-us-state
                { display: inline-block; *zoom: 1; *display: inline; vertical-align: middle }
        </xh:style>
        <xf:model id="fr-form-model" xxf:xpath-analysis="true">
            <xf:instance id="fr-form-instance">
                <form>
                    <personal-information>
                        <last-name/>
                        <first-name/>
                        <initial/>
                        <icon-1 filename="user_48.png" mediatype="image/png" size="">oxf:/forms/orbeon/dmv-14/images/user_48.png</icon-1>
                        <driver-license-number/>
                        <birth-date/>
                        <voter-address-change/>
                    </personal-information>
                    <residence-address>
                        <residence-street-number/>
                        <residence-street-name-1/>
                        <residence-street-name-2/>
                        <icon-2 filename="home_48.png" mediatype="image/png" size="">oxf:/forms/orbeon/dmv-14/images/home_48.png</icon-2>
                        <residence-apt/>
                        <residence-city/>
                        <residence-state/>
                        <residence-zip/>
                    </residence-address>
                    <mailing-address>
                        <mailing-address-different/>
                        <mailing-street-number/>
                        <mailing-street-name-1/>
                        <mailing-street-name-2/>
                        <icon-3 filename="letter_48.png" mediatype="image/png" size="">oxf:/forms/orbeon/dmv-14/images/letter_48.png</icon-3>
                        <mailing-apt/>
                        <mailing-city/>
                        <mailing-state/>
                        <mailing-zip/>
                    </mailing-address>
                    <vehicles>
                        <vehicle>
                            <plate-number/>
                            <vin/>
                            <leased/>
                        </vehicle>
                        <leasing-company-name/>
                    </vehicles>
                    <old-address>
                        <old-street-number-name/>
                        <old-city/>
                        <old-state/>
                        <old-zip/>
                    </old-address>
                    <trailer-coach-vessel>
                        <has-trailer-coach-vessel/>
                        <vehicle-street-number/>
                        <vehicle-street-name-1/>
                        <vehicle-street-name-2/>
                        <vehicle-city/>
                        <vehicle-county/>
                    </trailer-coach-vessel>
                </form>
            </xf:instance>
            <xf:bind id="fr-form-binds" ref=".">
                <xf:bind id="personal-information-bind" ref="personal-information"
                             name="personal-information">
                    <xf:bind id="birth-date-bind" ref="birth-date" type="xs:date" required="true()"/>
                    <xf:bind id="icon-1-bind" ref="icon-1" type="xf:anyURI" name="icon-1"/>
                    <xf:bind id="voter-address-change-bind" ref="voter-address-change"
                                 name="voter-address-change"
                                 type="xf:boolean"/>
                    <xf:bind id="last-name-bind" ref="last-name" name="last-name" type="dmv:last-name"
                                 required="true()"
                                 />
                    <xf:bind id="first-name-bind" ref="first-name" name="first-name"
                                 type="dmv:first-name"
                                 required="true()"
                                 />
                    <xf:bind id="driver-license-number-bind" ref="driver-license-number"
                                 name="driver-license-number"
                                 type="dmv:driver-license-number"
                                 required="true()"
                                 />
                    <xf:bind id="initial-bind" ref="initial" name="initial" type="dmv:initial"/>
                </xf:bind>
                <xf:bind id="residence-address-bind" ref="residence-address"
                             name="residence-address">
                    <xf:bind id="icon-2-bind" ref="icon-2" name="icon-2" type="xf:anyURI"/>
                    <xf:bind id="residence-street-name-1-bind" ref="residence-street-name-1"
                                 name="residence-street-name-1"
                                 type="dmv:street-name-1"
                                 required="true()"
                                 />
                    <xf:bind id="residence-city-bind" ref="residence-city" name="residence-city"
                                 type="dmv:city"
                                 required="true()"
                                 />
                    <xf:bind id="residence-state-bind" ref="residence-state" name="residence-state"
                                 type="dmv:state"
                                 required="true()"
                                 />
                    <xf:bind id="residence-zip-bind" ref="residence-zip" name="residence-zip"
                                 type="dmv:zip"
                                 required="true()"
                                 />
                    <xf:bind id="residence-street-number-bind" ref="residence-street-number"
                                 name="residence-street-number"
                                 type="dmv:street-number"/>
                    <xf:bind id="residence-street-name-2-bind" ref="residence-street-name-2"
                                 name="residence-street-name-2"
                                 type="dmv:street-name-2"/>
                    <xf:bind id="residence-apt-bind" ref="residence-apt" name="residence-apt"
                                 type="dmv:apt"/>

                </xf:bind>
                <xf:bind id="mailing-address-bind" ref="mailing-address" name="mailing-address">
                    <xf:bind id="mailing-address-different-bind" ref="mailing-address-different" type="xf:boolean"/>
                    <xf:bind id="icon-3-bind" ref="icon-3" type="xs:anyURI"/>
                    <xf:bind id="mailing-street-name-1-bind" ref="mailing-street-name-1"
                                 name="mailing-street-name-1"
                                 type="dmv:street-name-1"
                                 required="true()"
                                 />
                    <xf:bind id="mailing-city-bind" ref="mailing-city" name="mailing-city"
                                 type="dmv:city"
                                 required="true()"
                                 />
                    <xf:bind id="mailing-state-bind" ref="mailing-state" name="mailing-state"
                                 type="dmv:state"
                                 required="true()"
                                 />
                    <xf:bind id="mailing-zip-bind" ref="mailing-zip" name="mailing-zip" type="dmv:zip"
                                 required="true()"
                                 />
                    <xf:bind id="mailing-street-number-bind" ref="mailing-street-number"
                                 name="mailing-street-number"
                                 type="dmv:street-number"/>
                    <xf:bind id="mailing-street-name-2-bind" ref="mailing-street-name-2"
                                 name="mailing-street-name-2"
                                 type="dmv:street-name-2"/>
                    <xf:bind id="mailing-apt-bind" ref="mailing-apt" name="mailing-apt" type="dmv:apt"/>
                </xf:bind>
                <xf:bind id="vehicles-bind" ref="vehicles" name="vehicles">
                    <xf:bind ref="vehicle">
                        <xf:bind id="leased-bind" ref="leased" name="leased" type="xf:boolean"/>
                        <xf:bind id="plate-number-bind" ref="plate-number" name="plate-number"
                                     type="dmv:plate-number"
                                     required="true()"

                                     readonly="false()"
                                     calculate="upper-case(.)"/>
                        <xf:bind id="vin-bind" ref="vin" name="vin" type="dmv:vin" required="true()"

                                     readonly="false()"
                                     calculate="upper-case(.)"/>
                    </xf:bind>
                    <xf:bind id="leasing-company-name-bind" ref="leasing-company-name"
                                 name="leasing-company-name"
                                 type="dmv:company-name"/>
                </xf:bind>
                <xf:bind id="trailer-coach-vessel-bind" ref="trailer-coach-vessel"
                             name="trailer-coach-vessel">
                    <xf:bind id="has-trailer-coach-vessel-bind" ref="has-trailer-coach-vessel" type="xf:boolean"/>
                    <xf:bind id="vehicle-street-name-1-bind" ref="vehicle-street-name-1"
                                 name="vehicle-street-name-1"
                                 type="dmv:street-name-1"
                                 required="true()"
                                 />
                    <xf:bind id="vehicle-city-bind" ref="vehicle-city" name="vehicle-city"
                                 type="dmv:city"
                                 required="true()"
                                 />
                    <xf:bind id="vehicle-county-bind" ref="vehicle-county" name="vehicle-county"
                                 type="dmv:county"
                                 required="true()"
                                 />
                    <xf:bind id="vehicle-street-number-bind" ref="vehicle-street-number"
                                 name="vehicle-street-number"
                                 type="dmv:street-number"/>
                    <xf:bind id="vehicle-street-name-2-bind" ref="vehicle-street-name-2"
                                 name="vehicle-street-name-2"
                                 type="dmv:street-name-2"/>
                </xf:bind>
                <xf:bind id="old-address-bind" ref="old-address" name="old-address">
                    <xf:bind id="old-street-number-name-bind" ref="old-street-number-name"
                                 name="old-street-number-name"
                                 type="xs:string"
                                 required="true()"
                                 />
                    <xf:bind id="old-city-bind" ref="old-city" name="old-city" type="dmv:city"
                                 required="true()"
                                 />
                    <xf:bind id="old-state-bind" ref="old-state" name="old-state" type="dmv:state"
                                 required="true()"
                                 />
                    <xf:bind id="old-zip-bind" ref="old-zip" name="old-zip" type="dmv:zip"
                                 required="true()"
                                 />
                </xf:bind>
            </xf:bind>
            <xf:instance id="fr-form-metadata" xxf:readonly="true">
                <metadata>
                    <application-name>orbeon</application-name>
                    <form-name>DMV-14</form-name>
                    <title xml:lang="en">Notice of Change of Address</title>
                    <description xml:lang="en"/>
                    <author/>
                    <logo mediatype="" filename="" size=""/>
                </metadata>
            </xf:instance>
            <xf:instance id="fr-form-attachments">
                <attachments>
                    <css mediatype="text/css" filename="" size=""/>
                    <pdf mediatype="application/pdf" filename="dmv14.pdf" size="49933">oxf:/forms/orbeon/dmv-14/form/dmv14.pdf</pdf>
                </attachments>
            </xf:instance>
            <xf:instance id="fr-form-resources" xxf:readonly="true">
                <resources>
                    <resource xml:lang="en">
                        <old-street-number-name>
                            <label>Street Number/Name</label>
                            <hint/>
                        </old-street-number-name>
                        <old-city>
                            <label>City</label>
                            <hint/>
                        </old-city>
                        <old-state>
                            <label>State</label>
                            <hint/>
                        </old-state>
                        <old-zip>
                            <label>Zip</label>
                            <hint/>
                        </old-zip>
                        <vehicle-street-number>
                            <label>Street Number</label>
                            <hint/>
                        </vehicle-street-number>
                        <vehicle-street-name-1>
                            <label>Street Name 1</label>
                            <hint/>
                        </vehicle-street-name-1>
                        <vehicle-street-name-2>
                            <label>Street Name 2</label>
                            <hint/>
                        </vehicle-street-name-2>
                        <vehicle-city>
                            <label>City</label>
                            <hint/>
                        </vehicle-city>
                        <vehicle-county>
                            <label>County</label>
                            <hint/>
                        </vehicle-county>
                        <leasing-company-name>
                            <label>Leasing Company's Name</label>
                            <hint/>
                        </leasing-company-name>
                        <plate-number>
                            <label>CA plate/CF/Placard No.</label>
                            <hint/>
                        </plate-number>
                        <plate-preview>
                            <label>Licence Plate Preview</label>
                        </plate-preview>
                        <vin>
                            <label>Vehicle/Vessel Id Number</label>
                            <hint/>
                        </vin>
                        <leased>
                            <label>Check If Leased</label>
                            <hint/>
                            <item>
                                <label>Leased</label>
                                <value>true</value>
                            </item>
                        </leased>
                        <mailing-street-number>
                            <label>Street Number</label>
                            <hint/>
                        </mailing-street-number>
                        <mailing-street-name-1>
                            <label>Street Name 1</label>
                            <hint/>
                        </mailing-street-name-1>
                        <mailing-street-name-2>
                            <label>Street Name 2</label>
                            <hint/>
                        </mailing-street-name-2>
                        <icon-3>
                            <label/>
                            <hint/>
                        </icon-3>
                        <mailing-apt>
                            <label>Apt. No</label>
                            <hint/>
                        </mailing-apt>
                        <mailing-city>
                            <label>City</label>
                            <hint/>
                        </mailing-city>
                        <mailing-state>
                            <label>State</label>
                            <hint/>
                        </mailing-state>
                        <mailing-zip>
                            <label>Zip</label>
                            <hint/>
                        </mailing-zip>
                        <residence-street-number>
                            <label>Street Number</label>
                            <hint/>
                        </residence-street-number>
                        <residence-street-name-1>
                            <label>Street Name 1</label>
                            <hint/>
                        </residence-street-name-1>
                        <residence-street-name-2>
                            <label>Street Name 2</label>
                            <hint/>
                        </residence-street-name-2>
                        <icon-2>
                            <label/>
                            <hint/>
                        </icon-2>
                        <residence-apt>
                            <label>Apt. No</label>
                            <hint/>
                        </residence-apt>
                        <residence-city>
                            <label>City</label>
                            <hint/>
                        </residence-city>
                        <residence-state>
                            <label>State</label>
                            <hint/>
                        </residence-state>
                        <residence-zip>
                            <label>Zip</label>
                            <hint/>
                        </residence-zip>
                        <voter-address-change>
                            <hint/>
                            <item>
                                <label>Don't change my voting address</label>
                                <value>true</value>
                            </item>
                        </voter-address-change>
                        <personal-information>
                            <label>Personal Information</label>
                        </personal-information>
                        <last-name>
                            <label>Last Name</label>
                            <hint/>
                        </last-name>
                        <first-name>
                            <label>First Name</label>
                            <hint/>
                        </first-name>
                        <initial>
                            <label>Initial</label>
                            <hint/>
                        </initial>
                        <icon-1>
                            <label/>
                            <hint/>
                        </icon-1>
                        <driver-license-number>
                            <label>Driver License / Id Card No.</label>
                            <hint/>
                        </driver-license-number>
                        <birth-date>
                            <label>Birth Date</label>
                            <hint/>
                        </birth-date>
                        <residence-address>
                            <label>New or Correct Residence Address</label>
                            <hint/>
                        </residence-address>
                        <mailing-address-different>
                            <hint/>
                            <item>
                                <label>My mailing address is different from my residence address</label>
                                <value>true</value>
                            </item>
                        </mailing-address-different>
                        <mailing-address>
                            <label>New or Correct Mailing Address</label>
                            <hint/>
                        </mailing-address>
                        <vehicles>
                            <label>Vehicles, Vessels, or Placards Owned by You</label>
                            <hint/>
                        </vehicles>
                         <has-trailer-coach-vessel>
                            <hint/>
                            <item>
                                <label>Its location is different from my residence address</label>
                                <value>true</value>
                            </item>
                        </has-trailer-coach-vessel>
                        <old-address>
                            <label>Old Address</label>
                            <hint/>
                        </old-address>
                        <trailer-coach-vessel>
                            <label>Location of Trailer Coach or Vessel</label>
                            <hint/>
                        </trailer-coach-vessel>
                    </resource>
                </resources>
            </xf:instance>

            <xf:instance id="vehicle-template">
                <vehicle>
                    <plate-number/>
                    <vin/>
                    <leased/>
                </vehicle>
            </xf:instance>
            <xs:schema targetNamespace="http://orbeon.org/oxf/examples/dmv"
                       elementFormDefault="qualified"
                       attributeFormDefault="unqualified">

                <xs:simpleType name="requiredNonEmptyString">
                    <xs:restriction base="xs:string">
                        <xs:minLength value="1"/>
                        <xs:whiteSpace value="collapse"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="first-name">
                    <xs:restriction base="dmv:requiredNonEmptyString">
                        <xs:pattern value="[A-Z]([A-Z]|[a-z]|\-){0,9}"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="initial">
                    <xs:restriction base="xs:string">
                        <xs:pattern value="([A-Z])?"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="last-name">
                    <xs:restriction base="dmv:requiredNonEmptyString">
                        <xs:pattern value="[A-Z]([A-Z]|[a-z]|\-){0,19}"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="driver-license-number">
                    <xs:restriction base="dmv:requiredNonEmptyString">
                        <xs:maxLength value="8"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="change-address">
                    <xs:restriction base="xs:string">
                        <xs:enumeration value=""/>
                        <xs:enumeration value="N"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="street-number">
                    <xs:restriction base="xs:string">
                        <xs:pattern value="[0-9]{0,5}"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="street-name-1">
                    <xs:restriction base="dmv:requiredNonEmptyString">
                        <xs:pattern value="([A-Z]|[a-z])([A-Z]|[a-z]|[0-9]|\-|\.|\/|\s){0,20}"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="street-name-2">
                    <xs:restriction base="xs:string">
                        <xs:pattern value="([A-Z]|[a-z]|[0-9]|\-|\.|\/|\s){0,22}"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="apt">
                    <xs:restriction base="xs:string">
                        <xs:pattern value="([A-Z]|[a-z]|[0-9]){0,4}"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="plate-number">
                    <xs:restriction base="dmv:requiredNonEmptyString">
                        <xs:pattern value="([A-Z]|[a-z]|[1-9]){1,7}"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="vin">
                    <xs:restriction base="dmv:requiredNonEmptyString">
                        <xs:pattern value="([A-Z]|[a-z]|[0-9]){1,17}"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="zip">
                    <xs:restriction base="xs:string">
                        <xs:pattern value="\d{5}"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="city">
                    <xs:restriction base="dmv:requiredNonEmptyString">
                        <xs:pattern value="[A-Z]([A-Z]|[a-z]|\-|\s){1,21}"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="county">
                    <xs:restriction base="dmv:requiredNonEmptyString">
                        <xs:pattern value="[A-Z]([A-Z]|[a-z]|\-|\s){1,13}"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="company-name">
                    <xs:restriction base="xs:string">
                        <xs:pattern value="([A-Z]|[a-z]|\-|\.|\/|\s){0,22}"/>
                    </xs:restriction>
                </xs:simpleType>

                <xs:simpleType name="state">
                    <xs:restriction base="xs:string">
                        <xs:enumeration value="AL"/>
                        <xs:enumeration value="AK"/>
                        <xs:enumeration value="AZ"/>
                        <xs:enumeration value="AR"/>
                        <xs:enumeration value="CA"/>
                        <xs:enumeration value="CO"/>
                        <xs:enumeration value="CT"/>
                        <xs:enumeration value="DE"/>
                        <xs:enumeration value="DC"/>
                        <xs:enumeration value="FL"/>
                        <xs:enumeration value="GA"/>
                        <xs:enumeration value="HI"/>
                        <xs:enumeration value="ID"/>
                        <xs:enumeration value="IL"/>
                        <xs:enumeration value="IN"/>
                        <xs:enumeration value="IA"/>
                        <xs:enumeration value="KS"/>
                        <xs:enumeration value="LA"/>
                        <xs:enumeration value="ME"/>
                        <xs:enumeration value="MD"/>
                        <xs:enumeration value="MA"/>
                        <xs:enumeration value="MI"/>
                        <xs:enumeration value="MN"/>
                        <xs:enumeration value="MS"/>
                        <xs:enumeration value="MO"/>
                        <xs:enumeration value="MT"/>
                        <xs:enumeration value="NE"/>
                        <xs:enumeration value="NV"/>
                        <xs:enumeration value="NH"/>
                        <xs:enumeration value="NJ"/>
                        <xs:enumeration value="NM"/>
                        <xs:enumeration value="NY"/>
                        <xs:enumeration value="NC"/>
                        <xs:enumeration value="ND"/>
                        <xs:enumeration value="OH"/>
                        <xs:enumeration value="OK"/>
                        <xs:enumeration value="OR"/>
                        <xs:enumeration value="PA"/>
                        <xs:enumeration value="RI"/>
                        <xs:enumeration value="SC"/>
                        <xs:enumeration value="SD"/>
                        <xs:enumeration value="TN"/>
                        <xs:enumeration value="TX"/>
                        <xs:enumeration value="UT"/>
                        <xs:enumeration value="VT"/>
                        <xs:enumeration value="VA"/>
                        <xs:enumeration value="WA"/>
                        <xs:enumeration value="WV"/>
                        <xs:enumeration value="WI"/>
                        <xs:enumeration value="WY"/>
                        <xs:enumeration value="AS"/>
                        <xs:enumeration value="GU"/>
                        <xs:enumeration value="MP"/>
                        <xs:enumeration value="PR"/>
                    </xs:restriction>
                </xs:simpleType>

            </xs:schema>
        </xf:model>
    </xh:head>
    <xh:body>
        <fr:view>
            <xh:img src="/apps/fr/style/orbeon-logo-trimmed-transparent-42.png"/>
            <fr:body>
                <fr:section id="personal-information-section" bind="personal-information-bind">
                    <xf:label ref="$form-resources/personal-information/label"/>
                    <fr:grid>
                        <xh:tr>
                            <xh:td>
                                <xf:input id="last-name-control" class="fr-summary fr-search fr-width-100pc"
                                              bind="last-name-bind">
                                    <xf:label ref="$form-resources/last-name/label"/>
                                    <xf:hint ref="$form-resources/last-name/hint"/><xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td>
                                <xf:input id="first-name-control" class="fr-summary fr-search fr-width-100pc"
                                              bind="first-name-bind">
                                    <xf:label ref="$form-resources/first-name/label"/>
                                    <xf:hint ref="$form-resources/first-name/hint"/><xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td>
                                <xf:input id="initial-control" class="fr-width-2em" bind="initial-bind">
                                    <xf:label ref="$form-resources/initial/label"/>
                                    <xf:hint ref="$form-resources/initial/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td rowspan="2" style="width: 120px">
                                <xf:output xmlns="http://orbeon.org/oxf/xml/form-builder"
                                               xmlns:fb="http://orbeon.org/oxf/xml/form-builder"
                                               xmlns:xbl="http://www.w3.org/ns/xbl"
                                               mediatype="image/*"
                                               value="."
                                               bind="icon-1-bind"
                                               id="icon-1-control"
                                               class="fr-attachment">
                                    <xf:label ref="$form-resources/icon-1/label"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:output>

                            </xh:td>
                        </xh:tr>
                        <xh:tr>
                            <xh:td>
                                <xf:input id="driver-license-number-control" class="fr-summary fr-search fr-width-100pc"
                                              bind="driver-license-number-bind">
                                    <xf:label ref="$form-resources/driver-license-number/label"/>
                                    <xf:hint ref="$form-resources/driver-license-number/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td>
                                <xf:input id="birth-date-control" bind="birth-date-bind" class="fr-summary fr-search">
                                    <xf:label ref="$form-resources/birth-date/label"/>
                                    <xf:hint ref="$form-resources/birth-date/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td>
                                <xf:select appearance="full" id="voter-address-change-control"
                                               bind="voter-address-change-bind">
                                    <xf:label ref="$form-resources/voter-address-change/label"/>
                                    <xf:hint ref="$form-resources/voter-address-change/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    <xf:itemset ref="$form-resources/voter-address-change/item">
                                        <xf:label ref="label"/>
                                        <xf:value ref="value"/>
                                    </xf:itemset>
                                </xf:select>
                            </xh:td>
                        </xh:tr>
                    </fr:grid>
                    <fr:grid>
                        <xh:tr>
                            <xh:td>
                            </xh:td>
                        </xh:tr>
                    </fr:grid>
                </fr:section>
                <fr:section id="residence-address-section" bind="residence-address-bind">
                    <xf:label ref="$form-resources/residence-address/label"/>
                    <fr:grid>
                        <xh:tr>
                            <xh:td>
                                <xf:input id="residence-street-number-control" class="fr-width-5em"
                                              bind="residence-street-number-bind">
                                    <xf:label ref="$form-resources/residence-street-number/label"/>
                                    <xf:hint ref="$form-resources/residence-street-number/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td>
                                <xf:input id="residence-street-name-1-control" bind="residence-street-name-1-bind" class="fr-width-100pc">
                                    <xf:label ref="$form-resources/residence-street-name-1/label"/>
                                    <xf:hint ref="$form-resources/residence-street-name-1/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td>
                                <xf:input id="residence-street-name-2-control" bind="residence-street-name-2-bind" class="fr-width-100pc">
                                    <xf:label ref="$form-resources/residence-street-name-2/label"/>
                                    <xf:hint ref="$form-resources/residence-street-name-2/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td rowspan="3" style="width: 120px">
                                <xf:output xmlns="http://orbeon.org/oxf/xml/form-builder"
                                               xmlns:fb="http://orbeon.org/oxf/xml/form-builder"
                                               xmlns:xbl="http://www.w3.org/ns/xbl"
                                               mediatype="image/*"
                                               class="fr-attachment"
                                               value="."
                                               id="icon-2-control"
                                               bind="icon-2-bind">
                                    <xf:label ref="$form-resources/icon-2/label"/>
                                    

                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:output>

                            </xh:td>
                        </xh:tr>
                        <xh:tr>
                            <xh:td>
                                <xf:input id="residence-apt-control" class="fr-width-5em" bind="residence-apt-bind">
                                    <xf:label ref="$form-resources/residence-apt/label"/>
                                    <xf:hint ref="$form-resources/residence-apt/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td>
                                <xf:input id="residence-city-control" class="fr-width-100pc" bind="residence-city-bind">
                                    <xf:label ref="$form-resources/residence-city/label"/>
                                    <xf:hint ref="$form-resources/residence-city/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td>
                                <fr:us-state class="fr-width-10em" id="residence-state-control" bind="residence-state-bind">
                                    <xf:label ref="$form-resources/residence-state/label"/>
                                    <xf:hint ref="$form-resources/residence-state/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    <xf:itemset ref="$form-resources/residence-state/item">
                                        <xf:label ref="label"/>
                                        <xf:value ref="value"/>
                                    </xf:itemset>
                                </fr:us-state>
                                <xf:input id="residence-zip-control" class="fr-width-5em" bind="residence-zip-bind">
                                    <xf:label ref="$form-resources/residence-zip/label"/>
                                    <xf:hint ref="$form-resources/residence-zip/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                        </xh:tr>
                    </fr:grid>
                </fr:section>
                <fr:section id="mailing-address-section" bind="mailing-address-bind">
                    <fr:grid>
                        <xh:tr>
                            <xh:td>
                                <xf:select appearance="full" id="mailing-address-different-control"
                                               bind="mailing-address-different-bind">
                                    <xf:label ref="$form-resources/mailing-address-different/label"/>
                                    <xf:hint ref="$form-resources/mailing-address-different/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    <xf:itemset ref="$form-resources/mailing-address-different/item">
                                        <xf:label ref="label"/>
                                        <xf:value ref="value"/>
                                    </xf:itemset>
                                </xf:select>
                            </xh:td>
                        </xh:tr>
                    </fr:grid>
                    <!--
                        TODO: We should support relevance expression on fr:grid
                        Using a group is a workaround
                        Making the components inside the grid non-relevant has the following downsides
                            In Form Builder, the rule needs to be duplicated for every control
                            The grid still takes space on the page, even if the controls don't show
                    -->
                    <xf:group ref=".[mailing-address-different = 'true']">
                        <fr:grid>
                            <xh:tr>
                                <xh:td>
                                    <xf:input id="mailing-street-number-control" class="fr-width-5em"
                                                  bind="mailing-street-number-bind">
                                        <xf:label ref="$form-resources/mailing-street-number/label"/>
                                        <xf:hint ref="$form-resources/mailing-street-number/hint"/>    
                                        <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    </xf:input>
                                </xh:td>
                                <xh:td>
                                    <xf:input id="mailing-street-name-1-control" class="fr-width-100pc" bind="mailing-street-name-1-bind">
                                        <xf:label ref="$form-resources/mailing-street-name-1/label"/>
                                        <xf:hint ref="$form-resources/mailing-street-name-1/hint"/>    
                                        <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    </xf:input>
                                </xh:td>
                                <xh:td>
                                    <xf:input id="mailing-street-name-2-control" class="fr-width-100pc" bind="mailing-street-name-2-bind">
                                        <xf:label ref="$form-resources/mailing-street-name-2/label"/>
                                        <xf:hint ref="$form-resources/mailing-street-name-2/hint"/>    
                                        <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    </xf:input>
                                </xh:td>
                                <xh:td rowspan="3" style="width: 120px">
                                    <xf:output id="icon-3-control" mediatype="image/*" class="fr-attachment"
                                                   bind="icon-3-bind">
                                        <xf:label ref="$form-resources/icon-3/label"/>
                                        
                                        <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    </xf:output>
                                </xh:td>
                            </xh:tr>
                            <xh:tr>
                                <xh:td>
                                    <xf:input id="mailing-apt-control" class="fr-width-5em" bind="mailing-apt-bind">
                                        <xf:label ref="$form-resources/mailing-apt/label"/>
                                        <xf:hint ref="$form-resources/mailing-apt/hint"/>    
                                        <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    </xf:input>
                                </xh:td>
                                <xh:td>
                                    <xf:input id="mailing-city-control" class="fr-width-100pc" bind="mailing-city-bind">
                                        <xf:label ref="$form-resources/mailing-city/label"/>
                                        <xf:hint ref="$form-resources/mailing-city/hint"/>    
                                        <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    </xf:input>
                                </xh:td>
                                <xh:td>
                                    <fr:us-state class="fr-width-10em" id="mailing-state-control" bind="mailing-state-bind">
                                        <xf:label ref="$form-resources/mailing-state/label"/>
                                        <xf:hint ref="$form-resources/mailing-state/hint"/>    
                                        <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                        <xf:itemset ref="$form-resources/mailing-state/item">
                                            <xf:label ref="label"/>
                                            <xf:value ref="value"/>
                                        </xf:itemset>
                                    </fr:us-state>
                                    <xf:input id="mailing-zip-control" class="fr-width-5em" bind="mailing-zip-bind">
                                        <xf:label ref="$form-resources/mailing-zip/label"/>
                                        <xf:hint ref="$form-resources/mailing-zip/hint"/>    
                                        <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    </xf:input>
                                </xh:td>
                            </xh:tr>
                        </fr:grid>
                    </xf:group>
                    <xf:label ref="$form-resources/mailing-address/label"/>
                </fr:section>
                <fr:section id="vehicles-section" bind="vehicles-bind">
                    <xf:label ref="$form-resources/vehicles/label"/>
                    <fr:grid ref="vehicle" id="vehicle-repeat"
                             min="1"
                             max="3"
                             origin="instance('vehicle-template')">
                        <xh:tr>
                            <xh:td>
                                <xf:input id="plate-number-control" class="fr-width-7em" bind="plate-number-bind">
                                    <xf:label ref="$form-resources/plate-number/label"/>
                                    <xf:hint ref="$form-resources/plate-number/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td>
                                <xf:input id="vin-control" class="fr-width-100pc" bind="vin-bind">
                                    <xf:label ref="$form-resources/vin/label"/>
                                    <xf:hint ref="$form-resources/vin/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td>
                                <xf:select id="leased-control" appearance="full" bind="leased-bind">
                                    <xf:label ref="$form-resources/leased/label"/>
                                    <xf:hint ref="$form-resources/leased/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    <xf:itemset ref="$form-resources/leased/item">
                                        <xf:label ref="label"/>
                                        <xf:value ref="value"/>
                                    </xf:itemset>
                                </xf:select>
                            </xh:td>
                            <xh:td>
                                <fr:california-plate ref="plate-number">
                                    <xf:label ref="$form-resources/plate-preview/label"/>
                                </fr:california-plate>
                            </xh:td>
                        </xh:tr>
                    </fr:grid>
                    <fr:grid>
                        <xh:tr>
                            <xh:td>
                                <xf:input id="leasing-company-name-control" bind="leasing-company-name-bind">
                                    <xf:label ref="$form-resources/leasing-company-name/label"/>
                                    <xf:hint ref="$form-resources/leasing-company-name/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                        </xh:tr>
                    </fr:grid>
                </fr:section>
                <fr:section id="trailer-coach-vessel-section" bind="trailer-coach-vessel-bind">
                    <xf:label ref="$form-resources/trailer-coach-vessel/label"/>
                    <fr:grid>
                        <xh:tr>
                            <xh:td>
                                <xf:select appearance="full" id="has-trailer-coach-vessel-control"
                                               bind="has-trailer-coach-vessel-bind">
                                    <xf:label ref="$form-resources/has-trailer-coach-vessel/label"/>
                                    <xf:hint ref="$form-resources/has-trailer-coach-vessel/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    <xf:itemset ref="$form-resources/has-trailer-coach-vessel/item">
                                        <xf:label ref="label"/>
                                        <xf:value ref="value"/>
                                    </xf:itemset>
                                </xf:select>
                            </xh:td>
                        </xh:tr>
                    </fr:grid>
                    <!-- See comment above for a similar group for mailing-address-different -->
                    <xf:group ref=".[has-trailer-coach-vessel = 'true']">
                        <fr:grid>
                            <xh:tr>
                                <xh:td>
                                    <xf:input id="vehicle-street-number-control" class="fr-width-5em"
                                                  bind="vehicle-street-number-bind">
                                        <xf:label ref="$form-resources/vehicle-street-number/label"/>
                                        <xf:hint ref="$form-resources/vehicle-street-number/hint"/>    
                                        <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    </xf:input>
                                </xh:td>
                                <xh:td>
                                    <xf:input id="vehicle-street-name-1-control" class="fr-width-100pc" bind="vehicle-street-name-1-bind">
                                        <xf:label ref="$form-resources/vehicle-street-name-1/label"/>
                                        <xf:hint ref="$form-resources/vehicle-street-name-1/hint"/>    
                                        <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    </xf:input>
                                </xh:td>
                                <xh:td>
                                    <xf:input id="vehicle-street-name-2-control" class="fr-width-100pc" bind="vehicle-street-name-2-bind">
                                        <xf:label ref="$form-resources/vehicle-street-name-2/label"/>
                                        <xf:hint ref="$form-resources/vehicle-street-name-2/hint"/>    
                                        <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    </xf:input>
                                </xh:td>
                                <xh:td/>
                            </xh:tr>
                            <xh:tr>
                                <xh:td>
                                    <xf:input id="vehicle-city-control" class="fr-width-100pc" bind="vehicle-city-bind">
                                        <xf:label ref="$form-resources/vehicle-city/label"/>
                                        <xf:hint ref="$form-resources/vehicle-city/hint"/>    
                                        <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    </xf:input>
                                </xh:td>
                                <xh:td>
                                    <xf:input id="vehicle-county-control" class="fr-width-100pc" bind="vehicle-county-bind">
                                        <xf:label ref="$form-resources/vehicle-county/label"/>
                                        <xf:hint ref="$form-resources/vehicle-county/hint"/>    
                                        <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    </xf:input>
                                </xh:td>
                                <xh:td/>
                                <xh:td/>
                            </xh:tr>
                        </fr:grid>
                    </xf:group>
                </fr:section>
                <fr:section id="old-address-section" bind="old-address-bind">
                    <xf:label ref="$form-resources/old-address/label"/>
                    <fr:grid>
                        <xh:tr>
                            <xh:td>
                                <xf:input id="old-street-number-name-control" bind="old-street-number-name-bind">
                                    <xf:label ref="$form-resources/old-street-number-name/label"/>
                                    <xf:hint ref="$form-resources/old-street-number-name/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td>
                                <xf:input id="old-city-control" class="fr-width-100pc" bind="old-city-bind">
                                    <xf:label ref="$form-resources/old-city/label"/>
                                    <xf:hint ref="$form-resources/old-city/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td>
                                <fr:us-state class="fr-width-10em" id="old-state-control" bind="old-state-bind">
                                    <xf:label ref="$form-resources/old-state/label"/>
                                    <xf:hint ref="$form-resources/old-state/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                    <xf:itemset ref="$form-resources/old-state/item">
                                        <xf:label ref="label"/>
                                        <xf:value ref="value"/>
                                    </xf:itemset>
                                </fr:us-state>
                                <xf:input id="old-zip-control" class="fr-width-5em" bind="old-zip-bind">
                                    <xf:label ref="$form-resources/old-zip/label"/>
                                    <xf:hint ref="$form-resources/old-zip/hint"/>
                                    <xf:alert ref="$fr-resources/detail/labels/alert"/>
                                </xf:input>
                            </xh:td>
                            <xh:td/>
                        </xh:tr>
                    </fr:grid>
                </fr:section>
            </fr:body>
        </fr:view>
    </xh:body>
</xh:html>